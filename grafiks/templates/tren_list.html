{% extends 'admin.html' %}
{% load staticfiles %}
{% block style %}
.table-hover tbody tr:hover td, .table-hover tbody tr:hover th {  background-color: #9b9da0; }
{% endblock %}

{% block content %}
<script>
jQuery(document).ready(function($) {
  $(".clickable-row").click(function(e) {
// open modal
    $("#Treneris").modal('show');
// fill Form
    document.getElementById('t_id').value = $(this).children('td')[0].innerHTML;
    document.getElementById('t_slug').value = $(this).children('td')[1].innerHTML;
    var temp_v = $(this).children('td')[3].innerHTML;
    document.getElementById('t_vards').value = temp_v.substring(4, temp_v.length - 5);
    var temp_a = $(this).children('td')[4].innerHTML;
    document.getElementById('t_apraksts').value = temp_a.substring(4, temp_a.length - 5);
// fill text
    var img = $(this).children('td')[5].innerHTML;
    if (img != '') {
      document.getElementById('avatar').src = "http://pieraksts.vfabrika.lv/media/" + img;
    } else {
      document.getElementById('avatar').src = "http://pieraksts.vfabrika.lv{% static 'no-avatar.png' %}";
    }
    document.getElementById('vards').innerHTML = temp_v.substring(4, temp_v.length - 5);
    document.getElementById('apraksts').innerHTML = temp_a.substring(4, temp_a.length - 5);
  });
});

var countdown;
function submit_changes() { clearInterval(countdown); document.querySelector('#yes').value = "Izmaiņas tiek apstiprinātas"; }
function cancel() { $("#yes").hide(); $("#ok").show(); clearInterval(countdown); }
function apply() {
  $("#yes").show(); $("#ok").hide(); var slidetime = 14,
  display = document.querySelector('#yes'); startTimer(slidetime, display);
}
function startTimer(duration, display) {
  var timer = duration, seconds = 15; countdown = setInterval( function () {
    seconds = parseInt(timer % 60, 10); // seconds = seconds < 10 ? "0" + seconds : seconds;
    display.value = "Apstiprināt izmaiņas (" + seconds + ") ?"; --timer;
    if (seconds < 1) { $("#yes").hide(); $("#ok").show(); clearInterval(countdown); }
  }, 1000);}
</script>

<!-- klienta edit modal START -->
<div class="modal fade" id="Treneris" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
 <h3 style="margin-top:5px; margin-bottom:5px;"><span class="glyphicon glyphicon-user" aria-hidden="true"></span>&nbsp;&nbsp;Trenera kartiņa</h3>
</div>
<div class="modal-body">
 <form action="/reception/treneri/" method=POST>{% csrf_token %}
  <input type="hidden" id="t_id" name="t_id">
  <input type="hidden" id="t_slug" name="t_slug">
  <img id="avatar" style="width: 150px; height: 150px;">
  <table class="table table-condensed">
   <thead><tr><th style="width:30%;">Vārds</th><th>Apraksts</th></tr></thead>
   <tbody><tr>
    <td id="vards"></td>
    <td id="apraksts"></td>
   </tr><tr>
    <td><div class="form-group"><input type="text" id="t_vards" name="t_vards" class="form-control"></div></td>
    <td><div class="form-group"><input type="text" id="t_apraksts" name="t_apraksts" class="form-control"></div></td>
   </tr></tbody>
  </table>
</div>
<div class="modal-footer">
 <input class="btn btn-danger pull-left" type="submit" value="Apstiprināt izmaiņas (15) ?" style="display: none;" id="yes" onclick="submit_changes();">
 <button type="button" class="btn btn-danger" onclick="apply();" id="ok">Veikt izmaiņas</button>
 <button type="button" class="btn btn-default" data-dismiss="modal" onclick="cancel();">Aizvērt</button>
</form>
</div></div></div></div>
<!-- klienta edit modal END -->

<script>
</script>

<div class="container">
<button type="button" class="btn btn-success pull-right" style="margin-bottom: 5px;"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> &nbsp;Pievienot jaunu Treneri</button>
  <table class="table table-hover table-striped table-condensed">
    <thead>
      <tr style="background: #aaa;">
        <th style="vertical-align: top;">Bilde</th>
        <th style="vertical-align: top;">Vārds</th>
        <th style="vertical-align: top;">Apraksts</th>
      </tr>
    </thead>
    <tbody>
{% for t in treneri %}
      <tr class="clickable-row">
        <td style="display:none;">{{ t.id }}</>
        <td style="display:none;">{{ t.slug }}</td>
        <td>{% if t.avatar != "" %}
         <img src="http://pieraksts.vfabrika.lv/media/{{ t.avatar }}" style="width: 100px; height: 100px;">{% else %}
         <img src="{% static 'no-avatar.png' %}" style="width: 100px; height: 100px;">{% endif %}
        </td>
        <td><h3>{{ t.vards }}</h3></td>
        <td><h4>{{ t.apraksts }}</h4></td>
        <td style="display:none;">{{ t.avatar }}</td>
      </tr>
{% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
